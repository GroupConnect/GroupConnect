{% load static filename %}
<!DOCTYPE html>
<html>
    <head>
        <title> 掲示板 </title>
        <meta charset="utf-8">
        <meta name="description" content="">
        <meta name="author" content="">
        <meta name="viewport" content="width=device-width, inital-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
        <link rel="stylesheet" type="text/css" href="{% static 'GroupConnect/css/bord.css' %}" />
    </head>
    <body>
        <div  class="nav-bar fixed-top">
            <!-- ナビゲーションバー -->
            <nav class="navbar navbar-expand-sm navbar-light bar">
                <a class="navbar-brand groupconnect" href="{% url 'GroupConnect:mypage' %}">GroupConnect</a>
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#Navber" aria-controls="Navber" aria-expanded="false" aria-label="ナビゲーションの切替">
                    <span class="navbar-toggler-icon"></span>
                </button>
        
                <div class="collapse navbar-collapse" id="Navber">
                    <ul class="navbar-nav">
                        <li class="nav-item active dropdown">
                            <a href="#" class="nav-link dropdown-toggle" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            グループ
                            </a>
                            <div class="dropdown-menu menu" aria-labelledby="navbarDropdown">
                            {% for group in members %}
                                <a class="dropdown-item" href="{% url 'GroupConnect:group_top' group.pk %}">{{group.group_id.group_name}}</a>
                            {% endfor %}
                            <a class="dropdown-item" href="{% url 'GroupConnect:group_list'%}">グループ一覧へ</a>
                            </div>
                        </li>
                    </ul>
                    <ul class="navbar-nav">
                        <li class="nav-item active dropdown">
                            <a href="#" class="nav-link dropdown-toggle" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            アカウント
                            </a>
                            <div class="dropdown-menu menu" aria-labelledby="navbarDropdown">
                                <a class="dropdown-item" href="{% url 'GroupConnect:user_update' user.pk %}">プロフィール設定</a>
                                <a class="dropdown-item" href="#">メール設定</a>
                                <a class="dropdown-item" href="{% url 'GroupConnect:password_change' %}">パスワード設定</a>
                                <a class="dropdown-item" href="{% url 'GroupConnect:logout' %}">ログアウト</a>
                            </div>
                        </li>
                    </ul>
                    <ul class="navbar-nav">
                        <li class="nav-item active dropdown mega-dropdown">
                            <a href="#" class="nav-link dropdown-toggle" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                グループメニュー
                            </a>
                            <div class="dropdown-menu mega-dropdown-menu" aria-labelledby="navbarDropdown">
                                <a class="dropdown-item d-inline grname" href="{% url 'GroupConnect:group_top' group.pk %}">{{group.group_name}}</a>
                                <a class="dropdown-item d-inline" href="{% url 'GroupConnect:bordlist' group.pk %}">掲示板</a>
                                <a class="dropdown-item d-inline" href="{% url 'GroupConnect:member_list' group.pk %}">メンバー一覧</a>
                                <a class="dropdown-item d-inline" href="{% url 'GroupConnect:group_setting' group.pk %}">設定</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>
        </nav>
    </div>
    <div class="container-fluid" id="container">
            <div class="row">
                <!-- サイドバー -->
                <div class="col-lg-2 side">
                    <div class="row">
                        <div class="col-lg-12 side-top">
                            <nav class="navbar navbar-light">
                                <a class="navbar-brand side-grname" href="{% url 'GroupConnect:group_top' group.pk %}">{{group.group_name}}</a>
                            </nav>
                        </div>
                        <div class="col-lg-12 side-up">
                            <p class="d-inline navbar-brand bordlist">掲示板</p>
                        </div>

                        <div class="col-lg-12 side-middle d-inline">
                                <p class="d-inline ctgr">カテゴリ</p><br>
                                <a class="btn btn-danger float-right" id="Categorydelete">削除</a>
                               <!-- 削除モーダル -->
                                 <div class="modal fade" id="modal-delete-category">
                                 <div class="modal-dialog" role="document">
                                     <div class="modal-content">
                                         <!-- モーダルヘッダー -->
                                         <div class="modal-header">
                                             <p>カテゴリ削除</p>
                                         </div>
                                         <!-- モーダルボディ -->
                                         <div class="modal-body">
                                             <p>カテゴリを消す前に中に掲示板が残っているか<br>
                                                 確認してください。</p>
                                         </div>
                                         <div class="modal-footer">
                                             <button class="btn btn-primary" id="category-delete-submit">OK</button>
                                             <button class="btn btn-secondary" id="category-close">キャンセル</button>
                                         </div>
                                     </div>
                                 </div>
                                 </div>
                               <!-- 削除モーダル終わり -->
                                <form class="d-inline" id="category-add-errorcheck" method="POST">  
                                <a class="btn btn-primary float-left" id="btn" href="#"><addr title="カテゴリーの追加" class="d- inline create-ctgr">追加</addr></a>
                        </div>

                        <!-- サイドバーカテゴリー追加 -->
                        <div class="modal fade" id="modal">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <!-- モーダルヘッダー -->
                                    <div class="modal-header">
                                        <h5 class="modal-title">カテゴリー追加</h5>
                                    </div>
                                    <!-- モーダルボディ -->
                                    <div class="modal-body">
                                        <p class="modal-category2">カテゴリ</p>
                                        <p class="category-error">カテゴリ名が入力されていません。</p>
                                        <p class="category-error1">未分類は追加できません。</p>
                                        <input type="text" class="form-control" id="input-1" placeholder="カテゴリを入力" name="add">
                                        {% csrf_token %}
                                        <div class="modal-footer">
                                            <input type="hidden" name="group_pk" value="{{group.pk}}">
                                            <input type="submit" class="btn btn-primary" id="category-add-errorcheck" name="category-add" value="作成">
                                            <button type="button" class="btn btn-secondary" id="close">キャンセル</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                                </form>
                        <!-- カテゴリーコンテンツ -->
                        <form method="POST">
                        <table class="table table-hover">
                        <thead class="table-dark">
                            <tr>
                                <th>カテゴリー一覧</th>
                                <th scope="col-lg-2"></th>
                            </tr>
                        </thead>
                        <tbody class="side-tbody">
                            <tr>
                                <th><a href="{% url 'GroupConnect:bordlist' group.pk 0%}">すべて</a></th>
                            </tr>
                            {% for category in categorys %}
                            {% csrf_token %}
                                <tr>
                                    <th><a class="name_limit" href="{% url 'GroupConnect:bordlist' group.pk category.id %}">{{ category.name }}</a></th>
                                    {% if category.check == True  %}
                                    <td></td>
                                    {% else %}
                                    <td><button type="submit" class="btn-primary" id="category-delete" name="category-delete" value="{{ category.id }}">削除</button></td>
                                    {% endif %}
                                </tr>
                                {% endfor %}
                        </tbody>
                        </table>
                        </form>
                    </div>
                </div>
                <!-- メインコンテンツ -->
                <div class="col-lg-10 right">
                    <div class="row row3">
                        <div class="col-lg-12 up">
                            <div class="headline">
                                <nav aria-label="パンくずリスト">
                                    <ol class="breadcrumb">
                                        <li class="breadcrumb-item"><a href="bordlist">掲示板一覧</a></li>
                                        <li class="breadcrumb-item active" aria-current="page">{{ signboard.title }}</li>
                                    </ol>
                                </nav>
                                <nav class="navbar navbar-expand-md navbar-light bar3">
                                    <p class="bord-name">{{ signboard.title }}</p>
                                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav4" aria-controls="navbarNav4" aria-expanded="false" aria-label="Toggle navigation">
                                        <span class="navbar-toggler-icon"></span>
                                    </button>
                                    
                                    <div class="collapse navbar-collapse justify-content-end" id="navbarNav4">
                                    
                                        <div class="nav-item active dropdown signboard-setting">
                                            <button type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">昇順</button>
                                            <ul class="dropdown-menu">
                                                <li><button class="dropdown-item" value="昇順">昇順</button></li>
                                                <li><button class="dropdown-item" value="降順">降順</button></li>
                                            </ul>
                                        </div>

                                        <div class="nav-item active configuration signboard-setting">
                                            <a href="bord_setting"><button class="btn btn-secondary">掲示板設定</button></a>
                                        </div>
                                        <div class="nav-item active borddelete">
                                            <input type="button" class="btn btn-primary" data-toggle="modal" data-target="#basicModal" value="掲示板削除">
                                            <form class="d-inline" method="GET">
                                                {% csrf_token %}
                                                <div class="modal fade"id="basicModal"tabindex="-1"role="dialog"aria-labelledby="basicModal"aria-hidden="true">
                                                    <div class="modal-dialog">
                                                        <div class="modal-content">
                                                            <div class="modal-body">
                                                                <h3>この操作は元に戻せません。<br>掲示板を削除してもよろしいですか？</h3>
                                                            </div>
                                                            <div class="modal-footer">
                                                                <input type="submit" class="btn btn-primary" value="はい">
                                                                <button type="button" class="btn btn-default"data-dismiss="modal">いいえ</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </nav> 
                            </div>
                            <div class="post-area">
                                <div class="rounded p-4 background area">
                                    <form action="bord" id="post-form" method="get" enctype="multipart/form-data">
                                        {% csrf_token %}
                                        <div class="form-group d-inline">
                                                <textarea class="form-control" id="UserInput" rows="6"></textarea>
                                                <!-- <input type="file" name="s_file" class="file-select"> -->
                                                <div class="form-group file-choice">
                                                    <div id="file" class="input-group">
                                                        <div class="custom-file">
                                                            <input type="file" id="cutomfile" class="custom-file-input" name="cutomfile[]" lang="ja" />
                                                            <label class="custom-file-label" for="customfile">ファイル選択...</label>
                                                        </div>
                                                        <div class="input-group-append">
                                                            <button type="button" class="btn btn-outline-secondary reset">取消</button>
                                                        </div>
                                                    </div>
                                                </div>
                                                <input type="button" id="button" class="btn btn-warning post-button" value="投稿">
                                        </div>         
                                    </form>
                                </div>

                                <div id="large-frame">

                                    {% for post in post_list %}
                                        <div class="post-frame" id="post-frame{{ forloop.counter0 }}">
                                            <div class="post-outside" id="post-outside1">
                                                <div class="post">
                                                    <p class="Contributor">{{ post.contributer }}</p><p class="time">{{ post.diff_date }}</p><a class="post-delete" data-toggle="modal" data-target="#basicModal3" href="">投稿を削除</a>
                                                    <p class="letter-body"><a href="{% url 'GroupConnect:signboard' signboard.id post.id %}" class="post-text">{{ post.text|linebreaks }}</a></p>
                                                    {% if post.attached_file %}
                                                        <a class="filename" href="{{ post.attached_file.url }}">{{ post.attached_file|get_filename }}
                                                            {% if post.is_image_type %}
                                                                <img src="{{ post.attached_file.url }}" id="passcheck2" class="download-icon">
                                                            {% endif %}
                                                        </a>
                                                    {% endif %}
                                                </div>
                                                
                                                {% comment %} <img src="{% static 'GroupConnect/img/返信アイコン.jpg' %}" class="reply-icon"><a class="reply" id="reply1" href="#">返信する</a> {% endcomment %}
                                                <button type="button" class="btn btn-light rounded-pill" id="reply-show{{ forloop.counter0 }}">返信フォームを表示</button>
                                                <button type="button" class="btn btn-light rounded-pill reply-hide" id="reply-hide{{ forloop.counter0 }}">返信フォームを隠す</button>

                                            </div>
                                            <form action="{% url 'GroupConnect:signboard' signboard.id %}" class="reply-form" id="post-form{{ forloop.counter0 }}" method="POST" enctype="multipart/form-data">
                                                {% csrf_token %}
                                                <div class="form-group d-inline">
                                                    <textarea class="form-control" id="UserInput" name="reply_text" rows="6"></textarea>
                                                    <input type="file" name="s_file" accept="image/png, image/jpeg, image/gif" class="file-select"　multiple>
                                                    <input type="hidden" name="reply_source" value="{{ post.id }}"></input>
                                                    <input type="submit" id="button" class="btn btn-warning reply-button" value="返信">
                                                </div>       
                                            </form>
                                        </div>
                                    {% endfor %}

                                    {% comment %} <div id="post-frame2">
                                        <div class="post-outside" id="post-outside2">
                                            <div class="post">
                                                <p class="Contributor">白方丈晴</p><p class="time">2時間前</p>
                                                <p class="read">既読：<a data-toggle="modal" data-target="#basicModal2" href="#">2件</a></p>
                                                
                                                <div class="modal fade"id="basicModal2"tabindex="-1"role="dialog"aria-labelledby="basicModal"aria-hidden="true">
                                                    <div class="modal-dialog">
                                                        <div class="modal-content">
                                                            
                                                            <div class="modal-header">
                                                                <h5 class="modal-title">既読状況</h5>
                                                            </div>
                                                            
                                                            <div class="modal-body">
                                                                <div>
                                                                    <p class="modal-read">既読者</p>
                                                                    <table class="tbl">
                                                                        <tr><td>河原たろう</td></tr>
                                                                        <tr><td>河原たろう</td></tr>
                                                                    </table>
                                                                </div>
                                                                <div>
                                                                    <p class="modal-notread">未読者</p>
                                                                    <table class="tbl">
                                                                        <tr><td>河原たろう</td></tr>
                                                                        <tr><td>河原たろう</td></tr>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                            
                                                            <div class="modal-footer">
                                                                <button type="button" class="btn btn-secondary ok" id="close" data-dismiss="modal">OK</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <a class="post-delete" data-toggle="modal" data-target="#basicModal3" href="">投稿を削除</a>
                                                <form class="d-inline" method="GET">
                                                    {% csrf_token %}
                                                    <div class="modal fade"id="basicModal3"tabindex="-1"role="dialog"aria-labelledby="basicModal"aria-hidden="true">
                                                        <div class="modal-dialog">
                                                            <div class="modal-content">
                                                                <div class="modal-body">
                                                                    <h3>投稿を削除してもよろしいですか？</h3>
                                                                </div>
                                                                <div class="modal-footer">
                                                                    <input type="submit" class="btn btn-primary" value="はい">
                                                                    <button type="button" class="btn btn-default"data-dismiss="modal">いいえ</button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </form>
                                                <p class="letter-body">こんにちは。</p>
                                                <a class="filename" href="#">minion.jpg</a><img src="{% static 'GroupConnect/img/ダウンロードアイコン.jpg' %}" id="passcheck2" class="download-icon">
                                            </div>
                                            <img src="{% static 'GroupConnect/img/返信アイコン.jpg' %}" id="passcheck2" class="reply-icon"><a class="reply" id="reply2" href="#">返信する</a>
                                            
                                            
                                        </div>
                                    </div>
                                    <div id="post-frame1">
                                        <div class="post-outside" id="post-outside1">
                                            <div class="post">
                                                <p class="Contributor">白方丈晴</p><p class="time">2時間前</p><p class="read">既読：<a data-toggle="modal" data-target="#basicModal2" href="#">2件</a></p><a class="post-delete" data-toggle="modal" data-target="#basicModal3" href="">投稿を削除</a>
                                                <p class="letter-body">こんにちは。</p>
                                                <a class="filename" href="#">minion.jpg</a><img src="{% static 'GroupConnect/img/ダウンロードアイコン.jpg' %}" id="passcheck2" class="download-icon">
                                            </div>
                                            
                                            <img src="{% static 'GroupConnect/img/返信アイコン.jpg' %}" id="passcheck2" class="reply-icon"><a class="reply" id="reply1" href="#">返信する</a>
                                            
                                        </div>
                                        <form action="bord" class="post-form" method="get" enctype="multipart/form-data">
                                            {% csrf_token %}
                                            <div class="form-group d-inline">
                                                    <textarea class="form-control" id="UserInput" rows="6"></textarea>
                                                    <input type="file" name="s_file" accept="image/png, image/jpeg, image/gif" class="file-select"　multiple>
                                                    <input type="button" id="button" class="btn btn-warning reply-button" value="返信">
                                            </div>       
                                        </form>
                                    </div> {% endcomment %}

                                </div>
                                
                            </div>    
                        </div>
                    </div>
                </div>         
            </div>
    </div>
    
            
            
            
        
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
        <script type="text/javascript" src="{% static 'GroupConnect/js/bord.js' %}"></script>
    </body>
</html>